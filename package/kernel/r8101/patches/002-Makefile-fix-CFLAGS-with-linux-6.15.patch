From 1bb099396afa88077b93bfdbd4d20dbdacea36eb Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=C3=81lvaro=20Fern=C3=A1ndez=20Rojas?= <noltari@gmail.com>
Date: Tue, 30 Dec 2025 14:38:03 +0100
Subject: [PATCH] Makefile: fix CFLAGS with linux 6.15+
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Ensure EXTRA_CFLAGS are taken into account.

Signed-off-by: Álvaro Fernández Rojas <noltari@gmail.com>
---
 src/Makefile | 2 ++
 1 file changed, 2 insertions(+)

--- a/src/Makefile
+++ b/src/Makefile
@@ -64,6 +64,8 @@ ifneq ($(KERNELRELEASE),)
 	ifeq ($(CONFIG_CTAP_SHORT_OFF), y)
 		EXTRA_CFLAGS += -DCONFIG_CTAP_SHORT_OFF
 	endif
+
+	ccflags-y += $(EXTRA_CFLAGS)
 else
 	BASEDIR := /lib/modules/$(shell uname -r)
 	KERNELDIR ?= $(BASEDIR)/build
