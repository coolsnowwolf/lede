{"version":3,"sources":["webpack://yacd/./src/api/logs.ts","webpack://yacd/./src/components/Logs.module.css","webpack://yacd/./node_modules/react-feather/dist/icons/search.js","webpack://yacd/./src/components/Search.module.css","webpack://yacd/./src/components/Search.js","webpack://yacd/./src/components/LogSearch.js","webpack://yacd/./src/components/Logs.js","webpack://yacd/./src/hooks/useRemainingViewPortHeight.js"],"names":["apiConfigSnapshot","controller","wsState","endpoint","textDecoder","TextDecoder","even","fetched","decoded","appendData","s","callback","o","JSON","parse","err","console","log","now","Date","time","toLocaleString","id","Math","floor","random","toString","pump","reader","appendLog","read","then","done","value","str","decode","stream","splits","split","lastSplit","length","i","fetchLogs","apiConfig","url","buildWebSocketURL","ws","WebSocket","addEventListener","_ev","baseURL","secret","logLevel","abort","signal","AbortController","getURLAndInit","init","fetch","response","body","getReader","aborted","message","fetchLogsWithFetch","event","data","_extends","Object","assign","target","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","Search","forwardRef","_ref","ref","_ref$color","color","_ref$size","size","rest","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","propTypes","displayName","dispatch","searchText","updateSearchText","useState","text","setText","updateSearchTextInternal","useCallback","v","updateSearchTextDebounced","useMemo","debounce","className","s0","type","onChange","e","connect","getSearchText","React","memo","useEffect","colors","debug","info","warning","error","LogLine","payload","style","backgroundColor","itemKey","index","PropTypes","Row","areEqual","logs","getLogsForDisplay","getLogLevel","getClashAPIConfig","appendLogInternal","useRemainingViewPortHeight","refLogsContainer","containerHeight","ContentHeader","title","LogSearch","paddingBottom","SvgYacd","itemCount","itemSize","itemData","useRef","useLayoutEffect","setContainerHeight","updateContainerHeight","top","current","getBoundingClientRect","window","innerHeight","removeEventListener"],"mappings":"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","file":"logs.6cb8be057767df8939ce.js","sourcesContent":["import { ClashAPIConfig } from 'src/types';\n\nimport { buildWebSocketURL, getURLAndInit } from '../misc/request-helper';\n\ntype LogsAPIConfig = ClashAPIConfig & { logLevel: string };\ntype LogEntry = {\n  time?: string;\n  id?: string;\n  even?: boolean;\n  // and some other props\n};\ntype AppendLogFn = (x: LogEntry) => void;\n\nconst endpoint = '/logs';\nconst textDecoder = new TextDecoder('utf-8');\n\nconst getRandomStr = () => {\n  return Math.floor((1 + Math.random()) * 0x10000).toString(16);\n};\n\nlet even = false;\nlet fetched = false;\nlet decoded = '';\n\nfunction appendData(s: string, callback: AppendLogFn) {\n  let o: LogEntry;\n  try {\n    o = JSON.parse(s);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.log('JSON.parse error', JSON.parse(s));\n  }\n\n  const now = new Date();\n  const time = now.toLocaleString('zh-Hans');\n  // mutate input param in place intentionally\n  o.time = time;\n  o.id = +now - 0 + getRandomStr();\n  o.even = even = !even;\n  callback(o);\n}\n\nfunction pump(reader: ReadableStreamDefaultReader, appendLog: AppendLogFn) {\n  return reader.read().then(({ done, value }) => {\n    const str = textDecoder.decode(value, { stream: !done });\n    decoded += str;\n\n    const splits = decoded.split('\\n');\n\n    const lastSplit = splits[splits.length - 1];\n\n    for (let i = 0; i < splits.length - 1; i++) {\n      appendData(splits[i], appendLog);\n    }\n\n    if (done) {\n      appendData(lastSplit, appendLog);\n      decoded = '';\n\n      // eslint-disable-next-line no-console\n      console.log('GET /logs streaming done');\n      fetched = false;\n      return;\n    } else {\n      decoded = lastSplit;\n    }\n    return pump(reader, appendLog);\n  });\n}\n\nlet apiConfigSnapshot: LogsAPIConfig;\nlet controller: AbortController;\n\n// 1 OPEN\n// other value CLOSED\n// similar to ws readyState but not the same\n// https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/readyState\nlet wsState: number;\nexport function fetchLogs(apiConfig: LogsAPIConfig, appendLog: AppendLogFn) {\n  if (fetched || wsState === 1) return;\n  wsState = 1;\n  const url = buildWebSocketURL(apiConfig, endpoint);\n  const ws = new WebSocket(url);\n  ws.addEventListener('error', () => (wsState = 3));\n  ws.addEventListener('close', function (_ev) {\n    wsState = 3;\n    fetchLogsWithFetch(apiConfig, appendLog);\n  });\n  ws.addEventListener('message', function (event) {\n    appendData(event.data, appendLog);\n  });\n}\n\nfunction fetchLogsWithFetch(apiConfig: LogsAPIConfig, appendLog: AppendLogFn) {\n  if (\n    controller &&\n    (apiConfigSnapshot.baseURL !== apiConfig.baseURL ||\n      apiConfigSnapshot.secret !== apiConfig.secret ||\n      apiConfigSnapshot.logLevel !== apiConfig.logLevel)\n  ) {\n    controller.abort();\n  } else if (fetched) {\n    return;\n  }\n\n  fetched = true;\n  apiConfigSnapshot = { ...apiConfig };\n\n  controller = new AbortController();\n  const signal = controller.signal;\n\n  const { url, init } = getURLAndInit(apiConfig);\n  fetch(url + endpoint + '?level=' + apiConfig.logLevel, {\n    ...init,\n    signal,\n  }).then(\n    (response) => {\n      const reader = response.body.getReader();\n      pump(reader, appendLog);\n    },\n    (err) => {\n      fetched = false;\n      if (signal.aborted) return;\n\n      // eslint-disable-next-line no-console\n      console.log('GET /logs error:', err.message);\n    }\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"logMeta\":\"_3rlaagQhmO\",\"logType\":\"_1Y8l2FW3db\",\"logTime\":\"_3RhnPkHfE2\",\"logText\":\"o1S9cV4T0R\",\"logsWrapper\":\"_3GIdCSyyS7\",\"log\":\"lUDfnPiNdD\",\"logPlaceholder\":\"PaFzglKCf5\",\"logPlaceholderIcon\":\"_29b6nIu_GY\"};","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef } from 'react';\nimport PropTypes from 'prop-types';\nvar Search = forwardRef(function (_ref, ref) {\n  var _ref$color = _ref.color,\n      color = _ref$color === void 0 ? 'currentColor' : _ref$color,\n      _ref$size = _ref.size,\n      size = _ref$size === void 0 ? 24 : _ref$size,\n      rest = _objectWithoutProperties(_ref, [\"color\", \"size\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    ref: ref,\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: size,\n    height: size,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    stroke: color,\n    strokeWidth: \"2\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, rest), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: \"11\",\n    cy: \"11\",\n    r: \"8\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: \"21\",\n    y1: \"21\",\n    x2: \"16.65\",\n    y2: \"16.65\"\n  }));\n});\nSearch.propTypes = {\n  color: PropTypes.string,\n  size: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n};\nSearch.displayName = 'Search';\nexport default Search;","// extracted by mini-css-extract-plugin\nexport default {\"RuleSearch\":\"_2QPZldYe9U\",\"RuleSearchContainer\":\"_2PCUI90lIf\",\"inputWrapper\":\"xOYTLnYrng\",\"input\":\"_1JKQs_Qawx\",\"iconWrapper\":\"_2km92h_dfH\"};","import debounce from 'lodash-es/debounce';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { Search as SearchIcon } from 'react-feather';\n\nimport s0 from './Search.module.css';\n\nfunction RuleSearch({ dispatch, searchText, updateSearchText }) {\n  const [text, setText] = useState(searchText);\n  const updateSearchTextInternal = useCallback(\n    (v) => {\n      dispatch(updateSearchText(v));\n    },\n    [dispatch, updateSearchText]\n  );\n  const updateSearchTextDebounced = useMemo(\n    () => debounce(updateSearchTextInternal, 300),\n    [updateSearchTextInternal]\n  );\n  const onChange = (e) => {\n    setText(e.target.value);\n    updateSearchTextDebounced(e.target.value);\n  };\n\n  return (\n    <div className={s0.RuleSearch}>\n      <div className={s0.RuleSearchContainer}>\n        <div className={s0.inputWrapper}>\n          <input\n            type=\"text\"\n            value={text}\n            onChange={onChange}\n            className={s0.input}\n          />\n        </div>\n        <div className={s0.iconWrapper}>\n          <SearchIcon size={20} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default RuleSearch;\n","import { getSearchText, updateSearchText } from '../store/logs';\nimport Search from './Search';\nimport { connect } from './StateProvider';\n\nconst mapState = (s) => ({ searchText: getSearchText(s), updateSearchText });\nexport default connect(mapState)(Search);\n","import cx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { areEqual, FixedSizeList as List } from 'react-window';\n\nimport { fetchLogs } from '../api/logs';\nimport useRemainingViewPortHeight from '../hooks/useRemainingViewPortHeight';\nimport { getClashAPIConfig } from '../store/app';\nimport { getLogLevel } from '../store/configs';\nimport { appendLog, getLogsForDisplay } from '../store/logs';\nimport ContentHeader from './ContentHeader';\nimport s0 from './Logs.module.css';\nimport LogSearch from './LogSearch';\nimport { connect } from './StateProvider';\nimport SvgYacd from './SvgYacd';\n\nconst { useCallback, memo, useEffect } = React;\n\nconst paddingBottom = 30;\nconst colors = {\n  debug: 'none',\n  // debug: '#8a8a8a',\n  info: '#454545',\n  // info: '#147d14',\n  warning: '#b99105',\n  error: '#c11c1c',\n};\n\nfunction LogLine({ time, even, payload, type }) {\n  const className = cx({ even }, s0.log);\n  return (\n    <div className={className}>\n      <div className={s0.logMeta}>\n        <div className={s0.logTime}>{time}</div>\n        <div className={s0.logType} style={{ backgroundColor: colors[type] }}>\n          {type}\n        </div>\n        <div className={s0.logText}>{payload}</div>\n      </div>\n    </div>\n  );\n}\n\nLogLine.propTypes = {\n  time: PropTypes.string,\n  even: PropTypes.bool,\n  payload: PropTypes.string,\n  type: PropTypes.string,\n};\n\nfunction itemKey(index, data) {\n  const item = data[index];\n  return item.id;\n}\n\nconst Row = memo(({ index, style, data }) => {\n  const r = data[index];\n  return (\n    <div style={style}>\n      <LogLine {...r} />\n    </div>\n  );\n}, areEqual);\n\nfunction Logs({ dispatch, logLevel, apiConfig, logs }) {\n  const appendLogInternal = useCallback(\n    (log) => {\n      dispatch(appendLog(log));\n    },\n    [dispatch]\n  );\n  useEffect(() => {\n    fetchLogs({ ...apiConfig, logLevel }, appendLogInternal);\n  }, [apiConfig, logLevel, appendLogInternal]);\n  const [refLogsContainer, containerHeight] = useRemainingViewPortHeight();\n\n  return (\n    <div>\n      <ContentHeader title=\"Logs\" />\n      <LogSearch />\n      <div ref={refLogsContainer} style={{ paddingBottom }}>\n        {logs.length === 0 ? (\n          <div\n            className={s0.logPlaceholder}\n            style={{ height: containerHeight - paddingBottom }}\n          >\n            <div className={s0.logPlaceholderIcon}>\n              <SvgYacd width={200} height={200} />\n            </div>\n            <div>No logs yet, hang tight...</div>\n          </div>\n        ) : (\n          <div className={s0.logsWrapper}>\n            <List\n              height={containerHeight - paddingBottom}\n              width=\"100%\"\n              itemCount={logs.length}\n              itemSize={80}\n              itemData={logs}\n              itemKey={itemKey}\n            >\n              {Row}\n            </List>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst mapState = (s) => ({\n  logs: getLogsForDisplay(s),\n  logLevel: getLogLevel(s),\n  apiConfig: getClashAPIConfig(s),\n});\n\nexport default connect(mapState)(Logs);\n","import React from 'react';\n\nconst { useState, useRef, useCallback, useLayoutEffect } = React;\n\n/**\n * cosnt [ref, remainingHeight] = useRemainingViewPortHeight();\n *\n * return a reference, and the remaining height of the referenced dom node\n * to the bottom of the view port\n *\n */\nexport default function useRemainingViewPortHeight() {\n  const ref = useRef(null);\n  const [containerHeight, setContainerHeight] = useState(200);\n  const updateContainerHeight = useCallback(() => {\n    const { top } = ref.current.getBoundingClientRect();\n    setContainerHeight(window.innerHeight - top);\n  }, []);\n\n  useLayoutEffect(() => {\n    updateContainerHeight();\n    window.addEventListener('resize', updateContainerHeight);\n    return () => {\n      window.removeEventListener('resize', updateContainerHeight);\n    };\n  }, [updateContainerHeight]);\n\n  return [ref, containerHeight];\n}\n"],"sourceRoot":""}