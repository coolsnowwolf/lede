#!/bin/bash
# Copyright (C) 2019 Jerryk <jerrykuku@qq.com>
lua=/usr/bin/lua
name="$1"
host=$2
code=''
iso_array=(AC AD AE AF AG AI AL AM AO AQ AR AS AT AU AW AX AZ BA BB BD BE BF BG BH BI BJ BL BM BN BO BQ BR BS BT BV BW BY BZ CA CC CD CF CG CH CI CK CL CM CN CO CP CR CU CV CW CX CY CZ DE DG DJ DK DM DO DZ EA EC EE EG EH ER ES ET EU FI FJ FK FM FO FR GA GB GD GE GF GG GH GI GL GM GN GP GQ GR GS GT GU GW GY HK HM HN HR HT HU IC ID IE IL IM IN IO IQ IR IS IT JE JM JO JP KE KG KH KI KM KN KP KR KW KY KZ LA LB LC LI LK LR LS LT LU LV LY MA MC MD ME MF MG MH MK ML MM MN MO MP MQ MR MS MT MU MV MW MX MY MZ NA NC NE NF NG NI NL NO NP NR NU NZ OM PA PE PF PG PH PK PL PM PN PR PS PT PW PY QA RE RO RS RU RW SA SB SC SD SE SG SH SI SJ SK SL SM SN SO SR SS ST SV SX SY SZ TA TC TD TF TG TH TJ TK TL TM TN TO TR TT TV TW TZ UA UG UM UN US UY UZ VA VC VE VG VI VN VU WF WS XK YE YT ZA ZM ZW US HK TW JP GB GB DE FR IN TR SG KR RU IE)

emoji_array=(ðŸ‡¦ðŸ‡¨ ðŸ‡¦ðŸ‡© ðŸ‡¦ðŸ‡ª ðŸ‡¦ðŸ‡« ðŸ‡¦ðŸ‡¬ ðŸ‡¦ðŸ‡® ðŸ‡¦ðŸ‡± ðŸ‡¦ðŸ‡² ðŸ‡¦ðŸ‡´ ðŸ‡¦ðŸ‡¶ ðŸ‡¦ðŸ‡· ðŸ‡¦ðŸ‡¸ ðŸ‡¦ðŸ‡¹ ðŸ‡¦ðŸ‡º ðŸ‡¦ðŸ‡¼ ðŸ‡¦ðŸ‡½ ðŸ‡¦ðŸ‡¿ ðŸ‡§ðŸ‡¦ ðŸ‡§ðŸ‡§ ðŸ‡§ðŸ‡© ðŸ‡§ðŸ‡ª ðŸ‡§ðŸ‡« ðŸ‡§ðŸ‡¬ ðŸ‡§ðŸ‡­ ðŸ‡§ðŸ‡® ðŸ‡§ðŸ‡¯ ðŸ‡§ðŸ‡± ðŸ‡§ðŸ‡² ðŸ‡§ðŸ‡³ ðŸ‡§ðŸ‡´ ðŸ‡§ðŸ‡¶ ðŸ‡§ðŸ‡· ðŸ‡§ðŸ‡¸ ðŸ‡§ðŸ‡¹ ðŸ‡§ðŸ‡» ðŸ‡§ðŸ‡¼ ðŸ‡§ðŸ‡¾ ðŸ‡§ðŸ‡¿ ðŸ‡¨ðŸ‡¦ ðŸ‡¨ðŸ‡¨ ðŸ‡¨ðŸ‡© ðŸ‡¨ðŸ‡« ðŸ‡¨ðŸ‡¬ ðŸ‡¨ðŸ‡­ ðŸ‡¨ðŸ‡® ðŸ‡¨ðŸ‡° ðŸ‡¨ðŸ‡± ðŸ‡¨ðŸ‡² ðŸ‡¨ðŸ‡³ ðŸ‡¨ðŸ‡´ ðŸ‡¨ðŸ‡µ ðŸ‡¨ðŸ‡· ðŸ‡¨ðŸ‡º ðŸ‡¨ðŸ‡» ðŸ‡¨ðŸ‡¼ ðŸ‡¨ðŸ‡½ ðŸ‡¨ðŸ‡¾ ðŸ‡¨ðŸ‡¿ ðŸ‡©ðŸ‡ª ðŸ‡©ðŸ‡¬ ðŸ‡©ðŸ‡¯ ðŸ‡©ðŸ‡° ðŸ‡©ðŸ‡² ðŸ‡©ðŸ‡´ ðŸ‡©ðŸ‡¿ ðŸ‡ªðŸ‡¦ ðŸ‡ªðŸ‡¨ ðŸ‡ªðŸ‡ª ðŸ‡ªðŸ‡¬ ðŸ‡ªðŸ‡­ ðŸ‡ªðŸ‡· ðŸ‡ªðŸ‡¸ ðŸ‡ªðŸ‡¹ ðŸ‡ªðŸ‡º ðŸ‡«ðŸ‡® ðŸ‡«ðŸ‡¯ ðŸ‡«ðŸ‡° ðŸ‡«ðŸ‡² ðŸ‡«ðŸ‡´ ðŸ‡«ðŸ‡· ðŸ‡¬ðŸ‡¦ ðŸ‡¬ðŸ‡§ ðŸ‡¬ðŸ‡© ðŸ‡¬ðŸ‡ª ðŸ‡¬ðŸ‡« ðŸ‡¬ðŸ‡¬ ðŸ‡¬ðŸ‡­ ðŸ‡¬ðŸ‡® ðŸ‡¬ðŸ‡± ðŸ‡¬ðŸ‡² ðŸ‡¬ðŸ‡³ ðŸ‡¬ðŸ‡µ ðŸ‡¬ðŸ‡¶ ðŸ‡¬ðŸ‡· ðŸ‡¬ðŸ‡¸ ðŸ‡¬ðŸ‡¹ ðŸ‡¬ðŸ‡º ðŸ‡¬ðŸ‡¼ ðŸ‡¬ðŸ‡¾ ðŸ‡­ðŸ‡° ðŸ‡­ðŸ‡² ðŸ‡­ðŸ‡³ ðŸ‡­ðŸ‡· ðŸ‡­ðŸ‡¹ ðŸ‡­ðŸ‡º ðŸ‡®ðŸ‡¨ ðŸ‡®ðŸ‡© ðŸ‡®ðŸ‡ª ðŸ‡®ðŸ‡± ðŸ‡®ðŸ‡² ðŸ‡®ðŸ‡³ ðŸ‡®ðŸ‡´ ðŸ‡®ðŸ‡¶ ðŸ‡®ðŸ‡· ðŸ‡®ðŸ‡¸ ðŸ‡®ðŸ‡¹ ðŸ‡¯ðŸ‡ª ðŸ‡¯ðŸ‡² ðŸ‡¯ðŸ‡´ ðŸ‡¯ðŸ‡µ ðŸ‡°ðŸ‡ª ðŸ‡°ðŸ‡¬ ðŸ‡°ðŸ‡­ ðŸ‡°ðŸ‡® ðŸ‡°ðŸ‡² ðŸ‡°ðŸ‡³ ðŸ‡°ðŸ‡µ ðŸ‡°ðŸ‡· ðŸ‡°ðŸ‡¼ ðŸ‡°ðŸ‡¾ ðŸ‡°ðŸ‡¿ ðŸ‡±ðŸ‡¦ ðŸ‡±ðŸ‡§ ðŸ‡±ðŸ‡¨ ðŸ‡±ðŸ‡® ðŸ‡±ðŸ‡° ðŸ‡±ðŸ‡· ðŸ‡±ðŸ‡¸ ðŸ‡±ðŸ‡¹ ðŸ‡±ðŸ‡º ðŸ‡±ðŸ‡» ðŸ‡±ðŸ‡¾ ðŸ‡²ðŸ‡¦ ðŸ‡²ðŸ‡¨ ðŸ‡²ðŸ‡© ðŸ‡²ðŸ‡ª ðŸ‡²ðŸ‡« ðŸ‡²ðŸ‡¬ ðŸ‡²ðŸ‡­ ðŸ‡²ðŸ‡° ðŸ‡²ðŸ‡± ðŸ‡²ðŸ‡² ðŸ‡²ðŸ‡³ ðŸ‡²ðŸ‡´ ðŸ‡²ðŸ‡µ ðŸ‡²ðŸ‡¶ ðŸ‡²ðŸ‡· ðŸ‡²ðŸ‡¸ ðŸ‡²ðŸ‡¹ ðŸ‡²ðŸ‡º ðŸ‡²ðŸ‡» ðŸ‡²ðŸ‡¼ ðŸ‡²ðŸ‡½ ðŸ‡²ðŸ‡¾ ðŸ‡²ðŸ‡¿ ðŸ‡³ðŸ‡¦ ðŸ‡³ðŸ‡¨ ðŸ‡³ðŸ‡ª ðŸ‡³ðŸ‡« ðŸ‡³ðŸ‡¬ ðŸ‡³ðŸ‡® ðŸ‡³ðŸ‡± ðŸ‡³ðŸ‡´ ðŸ‡³ðŸ‡µ ðŸ‡³ðŸ‡· ðŸ‡³ðŸ‡º ðŸ‡³ðŸ‡¿ ðŸ‡´ðŸ‡² ðŸ‡µðŸ‡¦ ðŸ‡µðŸ‡ª ðŸ‡µðŸ‡« ðŸ‡µðŸ‡¬ ðŸ‡µðŸ‡­ ðŸ‡µðŸ‡° ðŸ‡µðŸ‡± ðŸ‡µðŸ‡² ðŸ‡µðŸ‡³ ðŸ‡µðŸ‡· ðŸ‡µðŸ‡¸ ðŸ‡µðŸ‡¹ ðŸ‡µðŸ‡¼ ðŸ‡µðŸ‡¾ ðŸ‡¶ðŸ‡¦ ðŸ‡·ðŸ‡ª ðŸ‡·ðŸ‡´ ðŸ‡·ðŸ‡¸ ðŸ‡·ðŸ‡º ðŸ‡·ðŸ‡¼ ðŸ‡¸ðŸ‡¦ ðŸ‡¸ðŸ‡§ ðŸ‡¸ðŸ‡¨ ðŸ‡¸ðŸ‡© ðŸ‡¸ðŸ‡ª ðŸ‡¸ðŸ‡¬ ðŸ‡¸ðŸ‡­ ðŸ‡¸ðŸ‡® ðŸ‡¸ðŸ‡¯ ðŸ‡¸ðŸ‡° ðŸ‡¸ðŸ‡± ðŸ‡¸ðŸ‡² ðŸ‡¸ðŸ‡³ ðŸ‡¸ðŸ‡´ ðŸ‡¸ðŸ‡· ðŸ‡¸ðŸ‡¸ ðŸ‡¸ðŸ‡¹ ðŸ‡¸ðŸ‡» ðŸ‡¸ðŸ‡½ ðŸ‡¸ðŸ‡¾ ðŸ‡¸ðŸ‡¿ ðŸ‡¹ðŸ‡¦ ðŸ‡¹ðŸ‡¨ ðŸ‡¹ðŸ‡© ðŸ‡¹ðŸ‡« ðŸ‡¹ðŸ‡¬ ðŸ‡¹ðŸ‡­ ðŸ‡¹ðŸ‡¯ ðŸ‡¹ðŸ‡° ðŸ‡¹ðŸ‡± ðŸ‡¹ðŸ‡² ðŸ‡¹ðŸ‡³ ðŸ‡¹ðŸ‡´ ðŸ‡¹ðŸ‡· ðŸ‡¹ðŸ‡¹ ðŸ‡¹ðŸ‡» ðŸ‡¹ðŸ‡¼ ðŸ‡¹ðŸ‡¿ ðŸ‡ºðŸ‡¦ ðŸ‡ºðŸ‡¬ ðŸ‡ºðŸ‡² ðŸ‡ºðŸ‡³ ðŸ‡ºðŸ‡¸ ðŸ‡ºðŸ‡¾ ðŸ‡ºðŸ‡¿ ðŸ‡»ðŸ‡¦ ðŸ‡»ðŸ‡¨ ðŸ‡»ðŸ‡ª ðŸ‡»ðŸ‡¬ ðŸ‡»ðŸ‡® ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡º ðŸ‡¼ðŸ‡« ðŸ‡¼ðŸ‡¸ ðŸ‡½ðŸ‡° ðŸ‡¾ðŸ‡ª ðŸ‡¾ðŸ‡¹ ðŸ‡¿ðŸ‡¦ ðŸ‡¿ðŸ‡² ðŸ‡¿ðŸ‡¼ ç¾Žå›½ é¦™æ¸¯ å°æ¹¾ æ—¥æœ¬ è‹±å›½ UK å¾·å›½ æ³•å›½ å°åº¦ åœŸè€³å…¶ æ–°åŠ å¡ éŸ©å›½ ä¿„ç½—æ–¯ çˆ±å°”å…°)


for i in "${!emoji_array[@]}"; do
    if [[ $name == *${emoji_array[$i]}* ]]; then
        code=${iso_array[$i]}
        break
    fi
done

if [ ! -z $code ]; then
    echo $code | tr "[A-Z]" "[a-z]"
else

    
    if echo $host | grep -E "^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$" >/dev/null; then
        hostip=${host}
    elif [ "$host" != "${host#*:[0-9a-fA-F]}" ]; then
        hostip=${host}
    else
        hostip=$(nslookup ${host} | grep 'Address 1' | sed 's/Address 1: //g')
        if echo $hostip | grep -E "^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$" >/dev/null; then
            hostip=${hostip}
        else
            hostip=$(cat /etc/ssr_ip)
        fi
    fi
    lua /usr/share/vssr/iso_code.lua $hostip
fi
