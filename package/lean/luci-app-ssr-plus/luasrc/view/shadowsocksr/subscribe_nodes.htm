<%+cbi/valueheader%>

<script type="text/javascript">//<![CDATA[

	function subscribe_nodes(btn,dataname) {
		btn.disabled = true;
		btn.value    = '<%:Refresh...%>';
		murl=dataname;
		XHR.get('<%=luci.dispatcher.build_url("admin", "services", "shadowsocksr","subscribe")%>',
			{ set:murl },
			function(x, rv) {
			if(x.readyState === 4 ) {
			if(x.status === 200) {try{res = JSON.parse(x.responseText);}catch(e){res=null;}
			if(res !==null && typeof(res) === "object") { var s = document.getElementById(dataname+'-status'); if (s) { s.innerHTML = res.ret; if (res.ret=="0") s.innerHTML = '<font color="green"><%:No new data!%></font>'; else if(res.ret=="255") s.innerHTML = '<font color="red"><%:Refresh Error!%></font>'; else s.innerHTML = '<font color="green"><%:Refresh OK!%><%:Total Records:%>'+rv.ret+'</font>'; }; btn.disabled = false; btn.value = '<%:Refresh Data%>'; }
			}}});
			return false;

	}
//]]></script>

<input type="button" class="cbi-button cbi-input-apply" value="<%:Update All Subscribe Severs%> " onclick="return subscribe_nodes(this,'<%=self.option%>')" />
<span id="<%=self.option%>-status"><em><%=self.value%></em></span>

<%+cbi/valuefooter%>